(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[297],{20749:(e,t,n)=>{Promise.resolve().then(n.bind(n,12532)),Promise.resolve().then(n.bind(n,87553))},12532:(e,t,n)=>{"use strict";n.d(t,{default:()=>b});var a=n(95155),r=n(49522),o=n(58830),l=n(89547),s=n(19371),i=n(56668),c=n(72750),d=n(95809),u=n(95786),h=n(78194),x=n(73553),p=n(16343),v=n(64012),m=n(61075),j=n(48173),f=n.n(j),g=n(76046),y=n(63297);let b=function(e){let{children:t}=e,[n,{toggle:j}]=(0,u.useDisclosure)(),b=(0,g.usePathname)();return(0,a.jsxs)(r.AppShell,{header:{height:60},navbar:{width:300,breakpoint:"sm",collapsed:{mobile:!n}},padding:"md",children:[(0,a.jsx)(r.AppShell.Header,{children:(0,a.jsxs)(o.Group,{align:"center",h:"100%",px:"md",children:[(0,a.jsx)(l.Burger,{opened:n,onClick:j,hiddenFrom:"sm",size:"sm","data-testid":"app-menu"}),(0,a.jsx)(s.Text,{flex:1,children:"Moon Clock"})]})}),(0,a.jsxs)(r.AppShell.Navbar,{p:"md",children:[(0,a.jsx)(i.NavLink,{component:f(),href:"/",label:"Panel",active:b.includes("/panel"),leftSection:(0,a.jsx)(c.ActionIcon,{variant:"light",children:(0,a.jsx)(h.A,{style:{width:"70%",height:"70%"},stroke:1.5})})}),(0,a.jsx)(i.NavLink,{component:f(),href:"/presets",label:"Presets","data-testid":"nav-presets",active:b.includes("/presets"),leftSection:(0,a.jsx)(c.ActionIcon,{variant:"light",children:(0,a.jsx)(x.A,{style:{width:"70%",height:"70%"},stroke:1.5})})}),(0,a.jsx)(i.NavLink,{component:f(),href:"/composer",label:"Composer",active:b.includes("/composer"),leftSection:(0,a.jsx)(c.ActionIcon,{variant:"light",children:(0,a.jsx)(p.A,{style:{width:"70%",height:"70%"},stroke:1.5})})}),(0,a.jsx)(i.NavLink,{component:f(),href:"/settings",label:"Settings",active:b.includes("/settings"),leftSection:(0,a.jsx)(c.ActionIcon,{variant:"light",children:(0,a.jsx)(v.A,{style:{width:"70%",height:"70%"},stroke:1.5})})})]}),(0,a.jsx)(r.AppShell.Main,{children:(0,a.jsx)(y.tH,{fallbackRender:e=>{let{error:t}=e;return console.log(t.stack),(0,a.jsx)(d.Alert,{title:"There was a problem!",color:"red",icon:(0,a.jsx)(m.A,{}),children:t.message})},children:t})})]})}},87553:(e,t,n)=>{"use strict";n.d(t,{Editor:()=>A});var a=n(95155),r=n(12115),o=n(58830),l=n(28708),s=n(61650),i=n(77052),c=n(3506),d=n(55866),u=n(86664),h=n(66327),x=n(95809),p=n(78778),v=n(95786),m=n(48366);function j(e){let{children:t,opacity:n}=e;return(0,a.jsx)("div",{style:{opacity:n,textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"},children:t})}function f(e){let{y:t,x:n,children:r}=e;return(0,a.jsx)("div",{style:{width:20,textAlign:"center",display:"inline-flex",alignItems:"center",justifyContent:"center",aspectRatio:"1/1"},children:r},"row_".concat(t,"_col_").concat(n))}function g(e){let{y:t,x:n,onClick:r,onMouseOver:o,matrix:l,showGrid:s}=e;return(0,a.jsx)("div",{"data-coordinates":"".concat(n,":").concat(t),onClick:r,onMouseOver:o,"data-testid":"dot-".concat(n,"-").concat(t),style:{backgroundColor:l["".concat(n,":").concat(t)]||"#000",height:"90%",width:"90%",display:"inline-block",borderRadius:3,boxShadow:"1px 1px 1px #333",border:s&&(15===n||15===t)?"1px solid #aaa":"none"}})}function y(e){let{activeColor:t,matrix:n,setMatrix:o,showGrid:l}=e,s=(0,r.useRef)(null),[i,c]=(0,r.useState)(!1);return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{ref:s,style:{background:"#000",position:"relative",touchAction:"none"},onMouseDown:()=>c(!0),onMouseUp:()=>c(!1),onTouchMove:e=>{let a=e.touches[0],r=document.elementFromPoint(a.clientX,a.clientY),{coordinates:l}=null==r?void 0:r.dataset;l&&o({...n,[l]:t})},children:(0,a.jsx)("div",{style:{zIndex:1,position:"relative"},children:[...Array(32).keys()].map(e=>(0,a.jsx)(j,{y:e,opacity:1,children:[...Array(32).keys()].map(r=>(0,a.jsx)(f,{y:e,x:r,children:(0,a.jsx)(g,{y:e,x:r,matrix:n,onClick:()=>{o({...n,["".concat(r,":").concat(e)]:t})},showGrid:l,onMouseOver:()=>{i&&o({...n,["".concat(r,":").concat(e)]:t})}})},"row_".concat(e,"_col_").concat(r)))},"row_".concat(e)))})})})}var b=n(75828);let S=(0,b.createServerReference)("40b5d2047e2757cff8c6d31ee1a9ab352e11e6bd08",b.callServer,void 0,b.findSourceMapURL,"updateCustomSceneData");function w(e){let{color:t,setActiveColor:n,activeColor:r,index:o}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{style:{width:"25px",height:"25px",background:t||"#000",border:t===r?"2px solid red":"none"},"data-testid":"color-".concat(o),onClick:()=>n(t)})})}let C=["#89CFF0","#facc0d"];function k(e){let{activeColor:t,setActiveColor:n,matrix:s}=e,[i,c]=(0,r.useState)(C);return(0,r.useEffect)(()=>{let e=new Set;for(let t in s)e.add(s[t]);c([...C,...e])},[JSON.stringify(s)]),(0,a.jsxs)(o.Group,{justify:"space-between",w:"100%",children:[(0,a.jsx)(o.Group,{gap:0,children:i.map((e,r)=>(0,a.jsx)(w,{color:e,setActiveColor:n,activeColor:t,index:r},"".concat(r,"-").concat(e)))}),(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),c([...i,e.target.elements.new_color.value])},children:(0,a.jsxs)(o.Group,{gap:"xs",children:[(0,a.jsx)("input",{type:"color",name:"new_color"}),(0,a.jsx)(l.Button,{type:"submit",size:"compact-sm",variant:"light",children:"Add"})]})})]})}function A(e){let{customScenes:t}=e,[n,j]=(0,r.useState)(t[0]),[f,g]=(0,r.useState)(!1),[b,w]=(0,r.useState)(null),[C,A]=(0,r.useState)({}),[P,_]=(0,r.useState)(""),[N,{open:T,close:R}]=(0,v.useDisclosure)(),I=(0,m.m)({mode:"uncontrolled",initialValues:{name:""}});return(0,r.useEffect)(()=>{n&&A(n.coordinates)},[n]),(0,a.jsxs)(s.Stack,{children:[(0,a.jsx)(i.Select,{placeholder:"Select a scene...",variant:"filled",style:{flex:1},value:null==n?void 0:n.name,"data-testid":"edit-scene-select",data:[{label:"New scene",value:"new-scene"},...null==t?void 0:t.map(e=>{let{name:t}=e;return{label:t,value:t}})],onChange:e=>{if("new-scene"===e)return T();let n=t.find(t=>{let{name:n}=t;return n===e});n&&j(n)}}),(0,a.jsx)(c.Modal,{title:"New scene",opened:N,onClose:R,children:(0,a.jsxs)("form",{onSubmit:I.onSubmit(async e=>{let{name:t}=e,n={name:t,coordinates:{}};await S(n),j(n),R()}),children:[(0,a.jsx)(d.TextInput,{label:"Scene Name","data-testid":"new-scene-name",...I.getInputProps("name")},I.key("name")),(0,a.jsx)(o.Group,{justify:"flex-end",mt:"md",children:(0,a.jsx)(l.Button,{type:"submit",children:"Create"})})]})}),C&&n&&(0,a.jsxs)(u.Tabs,{defaultValue:"editor",variant:"outline",onChange:e=>{"raw-data"===e&&_(JSON.stringify(C,null,2))},children:[(0,a.jsxs)(u.Tabs.List,{mb:"md",children:[(0,a.jsx)(u.Tabs.Tab,{value:"editor","data-testid":"editor-tab",children:"Editor"}),(0,a.jsx)(u.Tabs.Tab,{value:"raw-data","data-testid":"raw-data-tab",children:"Raw Data"})]}),(0,a.jsx)(u.Tabs.Panel,{value:"editor",children:(0,a.jsxs)(s.Stack,{children:[(0,a.jsx)(k,{activeColor:b,setActiveColor:w,matrix:C}),(0,a.jsx)(y,{activeColor:b,matrix:C,setMatrix:A,showGrid:f}),(0,a.jsx)(h.Checkbox,{checked:f,onChange:()=>g(e=>!e),label:"Show grid lines"}),(0,a.jsx)(l.Button,{onClick:()=>{S({name:n.name,coordinates:C})},children:"Save Scene"})]})}),(0,a.jsxs)(u.Tabs.Panel,{value:"raw-data",children:[(0,a.jsx)(x.Alert,{variant:"light",color:"red",my:"sm",children:"Raw Data Mode is only useful for importing or exporting scene data... Be careful!"}),(0,a.jsx)(p.Textarea,{"data-testid":"raw-data-textarea",value:P,onChange:e=>{let{value:t}=e.currentTarget;_(t)},rows:20}),(0,a.jsx)(l.Button,{mt:"md",fullWidth:!0,onClick:()=>{try{let e=JSON.parse(P);A(e),S({name:n.name,coordinates:e})}catch(e){alert(e)}},children:"Save Scene"})]})]})]})}},11595:(e,t,n)=>{"use strict";n.d(t,{Overlay:()=>m});var a=n(95155),r=n(57518);n(12115);var o=n(64065),l=n(14987),s=n(42075),i=n(61673),c=n(16407),d=n(5963),u=n(51743),h=n(60668),x={root:"m_9814e45f"};let p={zIndex:(0,o.getDefaultZIndex)("modal")},v=(0,s.createVarsResolver)((e,t)=>{let{gradient:n,color:a,backgroundOpacity:o,blur:s,radius:c,zIndex:d}=t;return{root:{"--overlay-bg":n||(void 0!==a||void 0!==o)&&(0,i.B)(a||"#000",null!=o?o:.6)||void 0,"--overlay-filter":s?"blur(".concat((0,r.D)(s),")"):void 0,"--overlay-radius":void 0===c?void 0:(0,l.getRadius)(c),"--overlay-z-index":null==d?void 0:d.toString()}}}),m=(0,h.polymorphicFactory)((e,t)=>{let n=(0,c.useProps)("Overlay",p,e),{classNames:r,className:o,style:l,styles:s,unstyled:i,vars:h,fixed:m,center:j,children:f,radius:g,zIndex:y,gradient:b,blur:S,color:w,backgroundOpacity:C,mod:k,...A}=n,P=(0,d.useStyles)({name:"Overlay",props:n,classes:x,className:o,style:l,classNames:r,styles:s,unstyled:i,vars:h,varsResolver:v});return(0,a.jsx)(u.Box,{ref:t,...P("root"),mod:[{center:j,fixed:m},k],...A,children:f})});m.classes=x,m.displayName="@mantine/core/Overlay"},69539:(e,t,n)=>{"use strict";n.d(t,{Paper:()=>x});var a=n(95155);n(12115);var r=n(14987),o=n(42075),l=n(16407),s=n(5963),i=n(51743),c=n(60668),d={root:"m_1b7284a3"};let u={},h=(0,o.createVarsResolver)((e,t)=>{let{radius:n,shadow:a}=t;return{root:{"--paper-radius":void 0===n?void 0:(0,r.getRadius)(n),"--paper-shadow":(0,r.getShadow)(a)}}}),x=(0,c.polymorphicFactory)((e,t)=>{let n=(0,l.useProps)("Paper",u,e),{classNames:r,className:o,style:c,styles:x,unstyled:p,withBorder:v,vars:m,radius:j,shadow:f,variant:g,mod:y,...b}=n,S=(0,s.useStyles)({name:"Paper",props:n,classes:d,className:o,style:c,classNames:r,styles:x,unstyled:p,vars:m,varsResolver:h});return(0,a.jsx)(i.Box,{ref:t,mod:[{"data-with-border":v},y],...S("root"),variant:g,...b})});x.classes=d,x.displayName="@mantine/core/Paper"},73343:(e,t,n)=>{"use strict";n.d(t,{getContrastColor:()=>o,getPrimaryContrastColor:()=>l});var a=n(56379),r=n(79299);function o(e){let{color:t,theme:n,autoContrast:a}=e;return("boolean"==typeof a?a:n.autoContrast)&&(0,r.parseThemeColor)({color:t||n.primaryColor,theme:n}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function l(e,t){return o({color:e.colors[e.primaryColor][(0,a.getPrimaryShade)(e,t)],theme:e,autoContrast:null})}},38185:(e,t,n)=>{"use strict";n.d(t,{getEnv:()=>r});var a=n(2818);function r(){return void 0!==a&&a.env?"production":"development"}}},e=>{var t=t=>e(e.s=t);e.O(0,[545,170,469,251,366,506,171,441,517,358],()=>t(20749)),_N_E=e.O()}]);