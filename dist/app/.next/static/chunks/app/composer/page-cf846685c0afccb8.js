(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[297],{20749:(e,t,n)=>{Promise.resolve().then(n.bind(n,12532)),Promise.resolve().then(n.bind(n,594))},12532:(e,t,n)=>{"use strict";n.d(t,{default:()=>w});var a=n(95155),l=n(49522),i=n(58830),s=n(89547),r=n(19371),o=n(56668),c=n(72750),d=n(95809),u=n(95786),h=n(78194),x=n(73553),p=n(16343),m=n(64012),j=n(61075),v=n(48173),f=n.n(v),g=n(76046),b=n(63297);let w=function(e){let{children:t}=e,[n,{toggle:v}]=(0,u.useDisclosure)(),w=(0,g.usePathname)();return(0,a.jsxs)(l.AppShell,{header:{height:60},navbar:{width:300,breakpoint:"sm",collapsed:{mobile:!n}},padding:"md",children:[(0,a.jsx)(l.AppShell.Header,{children:(0,a.jsxs)(i.Group,{align:"center",h:"100%",px:"md",children:[(0,a.jsx)(s.Burger,{opened:n,onClick:v,hiddenFrom:"sm",size:"sm","data-testid":"app-menu"}),(0,a.jsx)(r.Text,{flex:1,children:"Moon Clock"})]})}),(0,a.jsxs)(l.AppShell.Navbar,{p:"md",children:[(0,a.jsx)(o.NavLink,{component:f(),href:"/",label:"Panel",active:w.includes("/panel"),leftSection:(0,a.jsx)(c.ActionIcon,{variant:"light",children:(0,a.jsx)(h.A,{style:{width:"70%",height:"70%"},stroke:1.5})})}),(0,a.jsx)(o.NavLink,{component:f(),href:"/presets",label:"Presets","data-testid":"nav-presets",active:w.includes("/presets"),leftSection:(0,a.jsx)(c.ActionIcon,{variant:"light",children:(0,a.jsx)(x.A,{style:{width:"70%",height:"70%"},stroke:1.5})})}),(0,a.jsx)(o.NavLink,{component:f(),href:"/composer",label:"Composer",active:w.includes("/composer"),leftSection:(0,a.jsx)(c.ActionIcon,{variant:"light",children:(0,a.jsx)(p.A,{style:{width:"70%",height:"70%"},stroke:1.5})})}),(0,a.jsx)(o.NavLink,{component:f(),href:"/settings",label:"Settings",active:w.includes("/settings"),leftSection:(0,a.jsx)(c.ActionIcon,{variant:"light",children:(0,a.jsx)(m.A,{style:{width:"70%",height:"70%"},stroke:1.5})})})]}),(0,a.jsx)(l.AppShell.Main,{children:(0,a.jsx)(b.tH,{fallbackRender:e=>{let{error:t}=e;return console.log(t.stack),(0,a.jsx)(d.Alert,{title:"There was a problem!",color:"red",icon:(0,a.jsx)(j.A,{}),children:t.message})},children:t})})]})}},594:(e,t,n)=>{"use strict";n.d(t,{Editor:()=>A});var a=n(95155),l=n(12115),i=n(58830),s=n(28708),r=n(61650),o=n(77052),c=n(3506),d=n(55866),u=n(86664),h=n(66327),x=n(95809),p=n(78778),m=n(95786),j=n(48366);function v(e){let{children:t,opacity:n}=e;return(0,a.jsx)("div",{style:{opacity:n,textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center"},children:t})}function f(e){let{y:t,x:n,children:l}=e;return(0,a.jsx)("div",{style:{width:20,textAlign:"center",display:"inline-flex",alignItems:"center",justifyContent:"center",aspectRatio:"1/1"},children:l},"row_".concat(t,"_col_").concat(n))}function g(e){let{y:t,x:n,onClick:l,onMouseOver:i,matrix:s,showGrid:r}=e;return(0,a.jsx)("div",{"data-coordinates":"".concat(n,":").concat(t),onClick:l,onMouseOver:i,"data-testid":"dot-".concat(n,"-").concat(t),style:{backgroundColor:s["".concat(n,":").concat(t)]||"#000",height:"90%",width:"90%",display:"inline-block",borderRadius:3,boxShadow:"1px 1px 1px #333",border:r&&(15===n||15===t)?"1px solid #aaa":"none"}})}function b(e){let{activeColor:t,matrix:n,setMatrix:i,showGrid:s}=e,r=(0,l.useRef)(null),[o,c]=(0,l.useState)(!1);return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{ref:r,style:{background:"#000",position:"relative",touchAction:"none"},onMouseDown:()=>c(!0),onMouseUp:()=>c(!1),onTouchMove:e=>{let a=e.touches[0],l=document.elementFromPoint(a.clientX,a.clientY),{coordinates:s}=null==l?void 0:l.dataset;s&&i({...n,[s]:t})},children:(0,a.jsx)("div",{style:{zIndex:1,position:"relative"},children:[...Array(32).keys()].map(e=>(0,a.jsx)(v,{y:e,opacity:1,children:[...Array(32).keys()].map(l=>(0,a.jsx)(f,{y:e,x:l,children:(0,a.jsx)(g,{y:e,x:l,matrix:n,onClick:()=>{i({...n,["".concat(l,":").concat(e)]:t})},showGrid:s,onMouseOver:()=>{o&&i({...n,["".concat(l,":").concat(e)]:t})}})},"row_".concat(e,"_col_").concat(l)))},"row_".concat(e)))})})})}var w=n(75828);let S=(0,w.createServerReference)("400458691e5f39ddafa4bd0a14caf9150ec26e7e41",w.callServer,void 0,w.findSourceMapURL,"updateCustomSceneData");function y(e){let{color:t,setActiveColor:n,activeColor:l,index:i}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{style:{width:"25px",height:"25px",background:t||"#000",border:t===l?"2px solid red":"none"},"data-testid":"color-".concat(i),onClick:()=>n(t)})})}let k=["#89CFF0","#facc0d"];function C(e){let{activeColor:t,setActiveColor:n,matrix:r}=e,[o,c]=(0,l.useState)(k);return(0,l.useEffect)(()=>{let e=new Set;for(let t in r)e.add(r[t]);c([...k,...e])},[JSON.stringify(r)]),(0,a.jsxs)(i.Group,{justify:"space-between",w:"100%",children:[(0,a.jsx)(i.Group,{gap:0,children:o.map((e,l)=>(0,a.jsx)(y,{color:e,setActiveColor:n,activeColor:t,index:l},"".concat(l,"-").concat(e)))}),(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),c([...o,e.target.elements.new_color.value])},children:(0,a.jsxs)(i.Group,{gap:"xs",children:[(0,a.jsx)("input",{type:"color",name:"new_color"}),(0,a.jsx)(s.Button,{type:"submit",size:"compact-sm",variant:"light",children:"Add"})]})})]})}function A(e){let{customScenes:t}=e,[n,v]=(0,l.useState)(t[0]),[f,g]=(0,l.useState)(!1),[w,y]=(0,l.useState)(null),[k,A]=(0,l.useState)({}),[_,N]=(0,l.useState)(""),[T,{open:M,close:I}]=(0,m.useDisclosure)(),P=(0,j.m)({mode:"uncontrolled",initialValues:{name:""}});return(0,l.useEffect)(()=>{n&&A(n.coordinates)},[n]),(0,a.jsxs)(r.Stack,{children:[(0,a.jsx)(o.Select,{placeholder:"Select a scene...",variant:"filled",style:{flex:1},value:null==n?void 0:n.name,"data-testid":"edit-scene-select",data:[{label:"New scene",value:"new-scene"},...null==t?void 0:t.map(e=>{let{name:t}=e;return{label:t,value:t}})],onChange:e=>{if("new-scene"===e)return M();let n=t.find(t=>{let{name:n}=t;return n===e});n&&v(n)}}),(0,a.jsx)(c.Modal,{title:"New scene",opened:T,onClose:I,children:(0,a.jsxs)("form",{onSubmit:P.onSubmit(async e=>{let{name:t}=e,n={name:t,coordinates:{}};await S(n),v(n),I()}),children:[(0,a.jsx)(d.TextInput,{label:"Scene Name","data-testid":"new-scene-name",...P.getInputProps("name")},P.key("name")),(0,a.jsx)(i.Group,{justify:"flex-end",mt:"md",children:(0,a.jsx)(s.Button,{type:"submit",children:"Create"})})]})}),k&&n&&(0,a.jsxs)(u.Tabs,{defaultValue:"editor",variant:"outline",onChange:e=>{"raw-data"===e&&N(JSON.stringify(k,null,2))},children:[(0,a.jsxs)(u.Tabs.List,{mb:"md",children:[(0,a.jsx)(u.Tabs.Tab,{value:"editor","data-testid":"editor-tab",children:"Editor"}),(0,a.jsx)(u.Tabs.Tab,{value:"raw-data","data-testid":"raw-data-tab",children:"Raw Data"})]}),(0,a.jsx)(u.Tabs.Panel,{value:"editor",children:(0,a.jsxs)(r.Stack,{children:[(0,a.jsx)(C,{activeColor:w,setActiveColor:y,matrix:k}),(0,a.jsx)(b,{activeColor:w,matrix:k,setMatrix:A,showGrid:f}),(0,a.jsx)(h.Checkbox,{checked:f,onChange:()=>g(e=>!e),label:"Show grid lines"}),(0,a.jsx)(s.Button,{onClick:()=>{S({name:n.name,coordinates:k})},children:"Save Scene"})]})}),(0,a.jsxs)(u.Tabs.Panel,{value:"raw-data",children:[(0,a.jsx)(x.Alert,{variant:"light",color:"red",my:"sm",children:"Raw Data Mode is only useful for importing or exporting scene data... Be careful!"}),(0,a.jsx)(p.Textarea,{"data-testid":"raw-data-textarea",value:_,onChange:e=>{let{value:t}=e.currentTarget;N(t)},rows:20}),(0,a.jsx)(s.Button,{mt:"md",fullWidth:!0,onClick:()=>{try{let e=JSON.parse(_);A(e),S({name:n.name,coordinates:e})}catch(e){alert(e)}},children:"Save Scene"})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[545,170,469,251,366,479,506,229,441,517,358],()=>t(20749)),_N_E=e.O()}]);